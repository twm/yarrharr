/**
 * Global base styles for the Yarrharr UI.
 */
@import "~normalize.css/normalize.css";
@import "./globals.less";

:root {
    --layout-max-width: 50rem;

    --form-focus-color: @focus_blue;
}
.layout-wide {
    --layout-max-width: none;
}

html {
    line-height: 1.4;
    font-family: sans-serif;
    margin: 0;
    padding: 0;
    overflow-y: scroll;

    color: @content_text_color;
    background: @content_background_color;
    a {
        color: @content_text_color;
        text-decoration-line: underline;
        text-decoration-color: rgb(28, 140, 199);
    }
    a[role=button] {
        text-decoration-line: none;
    }
    a:visited {
        text-decoration-color: rgb(199, 68, 28);
    }
    a:visited:not([role=button]) {
        color: @content_text_color;
    }
    a:active {
        text-decoration-color: rgb(185, 28, 199);
    }
    a:link[aria-disabled=true],
    a:visited[aria-disabled=true] {
        text-decoration-line: none;
    }
}

main {
    min-height: 100vh; /* push the footer off the page */
}

h1 {
    font-weight: normal;
}

:focus {
    outline: 1px dotted;
}

/**
 * Base form styles
 *
 */
.form-item-layout() {
    display: block;
    box-sizing: border-box;
    width: 100%;
    height: 2.5rem;
    padding: 0 @text_padding;
    font: inherit;
    line-height: 2.1rem;
}
.form-item-focusable() {
    --border-color: @text_color;

    background: var(--background-color);
    border: @button_border_width solid var(--border-color);
    border-radius: @text_padding;
    transition: border-color 0.05s;

    &:focus {
        --border-color: @focus_blue_dark;
        --backgrond-color: white;
        --gradient-start: @focus_blue_light;
        --gradient-mid: @focus_blue;
        --gradient-end: @focus_blue;

        outline: none;
    }
}

label:not(.checkbox) {
    display: block;
    font-size: 0.9rem;
    color: @text_color;
}

label.checkbox {
    .form-item-layout;

    input[type=checkbox] {
        display: inline-block;
    }
}

input[type=text],
input[type=password],
input[type=url],
input[type=email],
select[multiple] {
    .form-item-layout;
    .form-item-focusable;

    color: @content_text_color;
    --border-color: @quiet_text_color;
}
select[multiple] {
    height: auto; /* allow size attribute to have an effect */
}

.text-button {
    .form-item-layout;
    .form-item-focusable;

    --gradient-start: white;
    --gradient-mid: gray;
    --gradient-end: gray;

    border-color: var(--border-color);
    text-shadow: var(--border-color) 0 0 .025rem; /* bump contrast */
    background: linear-gradient(to bottom, var(--gradient-start) 0%, var(--gradient-mid) 28%, var(--gradient-end) 100%);
    box-shadow: inset var(--gradient-start) 0 0 .25rem;
    padding: 0 0.75rem;

    &:active {
        background: linear-gradient(to top, var(--gradient-start) 0%, var(--gradient-mid) 28%, var(--gradient-end) 100%);
        box-shadow: inset var(--gradient-end) 0 0 .25rem;
    }
}

/**
 * A "primary" button represents the default action of the form. It is colored
 * bright orange to draw attention to it. This style must be combined with
 * .text-button, which provides layout.
 */
.text-button-primary {
    color: white;
    --border-color: @logo_orange_dark;
    --gradient-start: @logo_orange_light;
    --gradient-mid: @logo_orange;
    --gradient-end: @logo_orange;
}

/**
 * A "danger" button performs a destructive action like deletion. It has a red
 * border to provide an aura of the forbidden. This button must be combined
 * with .text-button, which provides layout.
 */
.text-button-danger {
    color: white;
    --border-color: #950015;
    --gradient-start: #da1732;
    --gradient-mid: #ba001a;
    --gradient-end: #ba001a;
}


.about-page {
    .about-page-inner {
        max-width: --layout-max-width;
        margin: 0 auto;
        padding: 1px 0 1px 0; /* disable margin collapsing */
    }
}

/* A "floater" is centered and is horizontally centered.  Mainly used for
 * mastheads and error messages.
 *
 * DEPRECATED
 */
.floater-wrap {
    display: flex; /* XXX Why is this display: flex? */
    margin: 1rem .25rem;
}
.floater {
    text-align: center;
    margin: 0 auto;
    box-sizing: border-box; /* Fix #94 */
    padding: .5rem 1rem;
    max-width: --layout-max-width;
}

.bar {
    display: flex;
    justify-content: space-between;
    height: @bar_height;
    max-width: var(--layout-max-width);
    margin: 0 auto;
    line-height: @bar_line_height;
    contain: size layout style;

    & > * {
        .flat-button;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    & > a[href]:focus {
        .flat-button-focus;
    }

    & .icon {
        display: block;
        font-size: @icon_size;
    }

    & > .square,
    & > .expand > .square {
        flex: 0 0 @bar_height;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    & > .expand {
        flex: 1 1 0;
        min-width: @bar_height; /* allow shrinking below content size */
    }
}

.bar-inset {
    /* This is a mockup so it is hidden for now. */
    visibility: hidden;

    flex: 1 0 0;
    min-width: 0; /* allow shrinking below content size */

    border: 2px solid rgb(167, 167, 167);
    color: rgb(40, 40, 40);

    padding: 0 .5rem;
    margin: 0.5rem 0;
    /*
    box-shadow: inset .01rem .01rem .25rem rgba(0, 0, 0, 0.25);
    */
    background: white;

    justify-content: start;

    .icon {
        flex: 0 0 1.3rem;
        margin: 0 0.5rem 0 0;
    }

    h1 {
        flex: 1 1 auto;
        min-width: 0;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        font: inherit;
        margin: 0 0.5rem 0 0;
    }
}

/**
 * <div.tabs>
 *   <div.tabs-inner>
 *      <a.tab>text</a>
 *      <a.tab disabled>current tab</a>
 *   </div>
 * </div>
 */
.tabs {
    border-bottom: 2px solid #666;
    contain: layout style;
    background: @content_background_color;
}
.tabs-inner {
    display: flex;
    margin: 0 auto -2px auto;
    padding: 0 0 0 .5rem;
    max-width: var(--layout-max-width);
    box-sizing: border-box;
}
/* base tab styles */
.tabs-inner > a {
    border: 2px solid #666;
    border-radius: .5rem .5rem 0 0;
    background: @content_background_color;
    text-decoration: none;
    line-height: 1.7;
    padding: 0.125rem 1rem 0 1rem;
    margin: 0 .5rem 0 0;
}
/* current tab */
.tabs-inner > a[aria-disabled="true"] {
    border-bottom-width: 0;
}
@media screen and (max-width: 34em) {
    .tabs-inner {
        padding: 0;
        min-height: 40px;  /* tappable size */
    }
    .tabs-inner > a {
        margin: 0;
        line-height: 1.2;
        border-radius: 0;
        padding-left: 0.1rem;
        padding-right: 0.1rem;
        flex-basis: 100%;
        text-align: center;
    }
    .tabs-inner > a + a {
        border-left-width: 0;
    }
    .tabs-inner > a:first-child {
        border-left-width: 0;
    }
    .tabs-inner > a:last-child {
        border-right-width: 0;
    }
}
/* TODO: Check what happens in very narrow windows. */
/* TODO: Make less ugly. */

/* Mostly used for the login page. */
form.small-form {
    display: block;
    margin: 0 auto;
    padding: 0.5rem 1rem;

    .errorlist {
        padding: 0;
        list-style: none;
        hyphens: auto;
    }
}

.login-page {
    display: flex;
    flex-flow: row wrap;
    align-items: center;

    margin: 0 auto;
    max-width: 35rem;

    @media screen and (orientation: landscape) {
        /* 8rem = approx. height of <footer> */
        min-height: calc(100vh - 8rem);
    }

    h1 {
        margin: 0;
        padding: 1rem 1rem;
        flex: 100 1 auto;

        text-align: center;

        img {
            display: block;
            margin: 0 auto;
        }
    }

    form {
        flex: 1 1 15rem;
        min-width: 0;
        margin: 1rem 0 0 0;

        @media screen and (orientation: portrait) {
            flex-basis: 100%;
        }
    }
}

footer {
    padding: 3em 0.25em;
    text-align: center;
    background: @background_color;
    color: lighten(@text_color, 40%);

    a {
        color: @text_color;
        text-decoration-line: underline;
    }
    a[role=button] {
        text-decoration-line: none;
    }
    a:visited:not([role=button]) {
        color: darken(@text_color, 20%);
    }
    a:link[aria-disabled=true],
    a:visited[aria-disabled=true] {
        text-decoration-line: none;
    }
}
